package main

import (
	"ROMProject/utils"
	"encoding/hex"
	log "github.com/sirupsen/logrus"
	"strings"
)

func main() {
	// For Testing Data collected from WireShark
	inputs := [1][2]string{
		{"020200e82559d1886296e002090051e83fd54e0c750d2861201a425b6242021000130b38511be22c2abd1dfa0efaed936a0148007801013d00c2ff010a320008e2a89186061a28343864623462353938656466333361646235626366356634323265316431313163356131326531631001189fc5a6f79f2f188112c602020007d393eab817e99802090023b1fbf3a7d742e477c23d7d265301ad020c000d53e97a41beec06f47170956cc9633c0148007801013d00c2ff010a320008e5a89186061a2831306565383764353937316230326338366264653361623437343864323733353265646534623837100118b6d9a6f79f2f01eb1250022900af1f064cda79d016cfcd2bb8e862f98a98983c619d8a5a3b9b6c8b2563b0109efde3237a85523f717bfdfa2454fa66bc036004dfd1b0300363f8a5f975b4469b4114017bf91217bc121e2443bcf21b494f915f09a41815dc2e33515db373556e27689154ff7c5715a1cec3fc59ad87dea894b59db247bf3733e49228c83fe7f02e4f4ee3ce44beddf6ce1e4cd739a08cd7a6da03e9342007984763ffd8a6e6efa6a0311abb3bbcc2ebc691fc261ebecb3a8f1f87998330ab8012d779c5ad861371ded6ca2bec1ac882f2a410186e3881a2849ec8e8c18e424dc92c132291bf072d724e9ff5e2ac972ef028157e142cfc588c715c5b4023e6191f45c13d979a3d207be26fdebccaf05c51d421b17a30934a24368a97896cbd94d0195a2af935dfd49ace7ca709d04cec0dff74f3e0ae58b925cf83f8c1a12f30463016033345bdcaf61b5790b7f9963af55c34eb0bc019a110a22bf4f0cb15e7df75623ea6c5b6c84691c3f7cfe0dde5b9b1bd483209d5dda7584c0361b2e0fe6a172e2958682c11004f24ebea37ba86a57d61566c637d9ea041b39efc5b68b877aa7bc6264ef03ddbdc847cd9ef8066d3cee06869d0bdec5882be38dfdb741c3f76e0cef10f04019f3dcb1bc8274bb46e0acb1a7b65f10e3529b3637f9531d113a5c00437f244ee7b6d3bac12ecdad8574566425484285085b4dd8ce9bea1ef61974a26b9796483cd7aef1bdd2e3637f4a43a03344cf16d647febe6735eea481562e501f10e4c066dbae08726fb96dc8c38b331d0dc24064726fd0511981e4d038af6c9da63bed95ca6d10374f5ffa45ad1a185599cafd454d6c9d3a6d17422ee54b091b2a9c55c48f41bdef8e5894fddaf5550ab1812ad041589d8321d1495077b7b78e255a0a2db6b1e3b9ec57bfc88db91ae8262bcefe188f76600b86db005e28efc09e2aa69445f8a23f550c4af08947bbac099a79ac77a7c211a06f6641aff6fb76c5ca1c606d1014f5518ac019872bb9b27b12ac4e4458d1ff2686ad198f3f7f2a1524179a1a610ccff8b29651e96bec62130e8fe503c8eea44d8e301ec7e4dde0ee24b78567163c6ede7f99d75014e23ad16503ce6e335b459ae186f36e05c73885898546689d65f75ad5c7b86540381494f20f9427bbc9e76155f299e374827dcccd4cbe03adcb4edb68cd23c7c20af341184d00855c06c2506adaf64f520b9bcbb078d113fe75fcf3197c492c022395ce2cce4866acac11b01fb64225b4c1d76f70378776d8e9d963369f76ae54ef9dd17f0f817fa7af1178d9b17e6adee660376bc8d07035ea7608adfedb1f965d05e67ffc9097cc136be537fb2860cf26e21cd5896bb0c944f9d9b9ec923da4d8a159e8d2f80a230716e58718c2c750dc9d38c461be007b1b867b87d05a66052993f4677a88b6199265440bc1e36cb2615c59087a9cfae13845d1c57309611d2604b5e154a0feb85cdd26cce6fd0760e278e5b3cdefd46fe2ecc8b66a2bbb14f61464df360817faf89baf79f1a6a4c0bb7300d9d6fd4d0762bfb72e15273e5d2e5c863e0629812967c9e4a80acf5516a09237da5ec7b15e3cf7e55cdaa3317e5342cdda7be4c329c2ee4d20d77e31fdc66f2c8b346d181708edd30feb68ccaacc3df621e9ca7bb03500220ea8b699062e7429db37397f646340bd086dfe801b0238d4362d9c4a84f328a5d8f3e090df867ab551bb5ccd3a93a760b337e54bb4caf58be6b1c9c51b7ccc10983bd7bd2b3cc82bb0ba0edb7b6f40c1fb378f197420b46ee63e759a9083588317ab17eb213cc30bbc7cd2569f10b9147495eaca3d93137c24570122fc60d534541e7816a6400fb76318288596f550fa7b4bf332554c766cec19c3d013e1d48ccaf001a2d5c5ad7c6d25c6600373f3ab1295d3c43f02f36556a5bad11c3cc4d3d5fcc334920b31f745eb5a3f09909aaad55fc2b817c2d8f729eba4e7c6e6fa2c84036cd6a345fc2535fb45aa81add12fe9d02f18316aa5e3d802ec717c003d71276b6dd73e419664ea7900583ef3a8e277898da31c7fcae7c04acec532c1bb621f2ebd10f9a921b155101a85270b7a94232fe8a4179cfdd970468718779b472c6094889966c1e9e03e20ea8e39697918c7bb77024d50abf47d542c6f429dc0e6b8fbd5b92525fd01032ef2dc200d43bcfb8c9c29bf1d76973c4d65618be993b426e1ece62f12f49fab400287ebd017dfe7072e0de6d834db864e7321a8b4541f80273b88fae9b403de84d5bbcd3f8c8c3420b51c37e7a0102a682c61fe611fba84e22aba1576e701395eeb82a128c72f7c1524e557dca1efa310219d01395dddea554446b2fc8711c9365afe95a60aeded7bfa4be9609502e92b2afe05b05dac90bb5d1de4e9e2cec0eeb7480dc479126f749f466dc10fa34636242e244940a2ee5c8165c8d6f7f3e9a8d1ff5c53e42d75bb192540c2450f4e5ef0bd32cccec4bb3ea3033c22d7b274e4ab24404c7b1035600d53222d6af07669cd4a7fb819a6a944be14ac20c5da3b414199cdb53388b225e955edaafdaa50cb7f0e2de468f6e9b2901e67d072a48b00d436617770a7823dfd667efa7e7803ca3e73d56fed4924071d3820459353dcece036500883ad44532b229caa0b01ee6e596dc8df5ca4e5256ebc01ce828671a615eb6695e4fc7adf62763e0bced6a5c173a0447c7d1e16ef9458db76409ce23e85dc4caabe7af40d283ec39983c39c2f632fd47478f856c32622b4293c35bc4ef3848acafa5cb3cbafd467f035600be67f3047c5af0d8d4a7fb819a6a944bd1f024a1804ff16d199cdb53388b225ee32db6718b92312af0e2de468f6e9b2901e67d072a48b00d436617770a7823dfd667efa7e7803ca3191624d7f687a164fee838d72df238e8020200693386e73b243c4702090027903264cc42187d078770a2534360830216008d0be6a10fbee78050f2ce16390edb33bdae7dbf36d2fefc021c00a799a362c01042958c94139d89e028015d77e7ffe5463553516dfbedf7b729f1022e00ef84bfb52a031fcabd60465ae720b3d945ee371c74e8b06dc974816ca1a86870f1e55d5640682c141892ba4e7101e979039a001733792e8650404c161e84c00abd2e28c2e2f7666a419c94538341b4390eedf6cea4f1eb9a45b870f8a31baad7e90f8e882bcae2904da7cdfad44e42063211073885fc9b12b070fe57ad7777a8fe71dd793bcfb827a3a8dcf597509d2344bc1e4863d7a73da6cfa8880f2122118d2485bf66c90cb1646da4a8a8d3501b9f1019fb29369acb8832e83098c08d756470e5ced9f65988d56f31a27890dc48ec108f021c00a799a362c0104295656f8dc8ef23206e9c37e2d0d62d111e869ecc8207c03f610148007801013d00c2ff010a320008e8a89186061a28613934383439396234393535356134373631353663363763613266313238393161336230666234661001189beda6f79f2fead211c20202004a82e5d3b13f1ab3020900938235f9bbec388d28c515c79c06d70f0143007801013800c7ff1202320008e8a89186061a283663343166343938623536623762323737616538653966333564643534376465343730623534633010021813af960e80022f001300df8b5153db69f18f5be6af6d2c744e041101391038d9066e6833d91bbd2ba1d9d07041bc1c2bcfb19d664456bc09020a00f5c18bfcc47056e9f91f650f205640aa02120004f124678d78a7dbfba0959bbe6d317806c6553fc50597e20149007801013e00c1ff3309320008eaa89186061a2831393739623866346561666231343036323839636565336130346534323962396466663434636639100120a297e692101801262411db02020099901e56a5a4ad9c021000d6b53764ec897e6195d39145c31546a8021400abb58181910c4ce07cd55a2cc86d9902a2f8c3e62315cc1e0352004e96546de981bc5a73abfe58c608524a8f361fa4f19aef663522e327e00c7e14166fe879cca7e9f43b7bf1708faf04e1977f8f3b8b7980044de1634f663b6efa58640104e373c6133ef6535ac68b134cbfc3adaef383cdd60343004cba6ff91d84ddf172d35e150907263fef81d028c076df107e8812792425ef08df19ee7f5573381b58585e2fccce70b19222876c601d6c8d89364e3e7b60bfe32fc99752f1cf599c0339003a9be36d479e64cef10e15b43a7c0fcf9bef68d80bf7258829e268d87b7b84adf1d3f58a7d34fa2a44874cd870bc0670f1bd7eebcf8bf6e8e7eedd91d4bf7e85021000977fdd8dc32ec121d4415f662e7a468b030a0150bb07151d4b79e0ce0ef99358bbeda811648b3140dc44e20f170dd5906c019ea26b11eafd36077865b6c8e6f8396e59efb98bed05b22192eea1451d74f086bc9676712b0c83a8a2675a6161b7605bb745ca235a63c9cfb43d3ab4f8d41439b33768f7655e4f61c0aba39535633d557dfb7c0814532d235e9b0888c97d0f407f212abbd11d1efd479b0d5ed05dfbc20cfbb44b97b26db7433544e00dfecbb140e6180e66afc35d3802d08456ac015c44efcfbbcf45634fbd42414f072ac7143310ce7fa0fea9ab0a94b4fa879ff716c24fb515b2609453f6273a745fbccb12cc7330a189826cef5ef6b316666af051d45bb9b8104245158b38be4bec841c023829907e2e385dcad5627202be7e83abec035000408ac49935fab6ed462cb30f84d59d6f4b813ea8b4ab4fcd3aa46f7e010e3a8650d9923bc54af1625f019895a8f923ce8738df87d66a11c1bb74197a8421759c11659ccdf2165b52d2a3a17a6508107903a30086cd5fd28879fba2b911f0a3bfb6f03e3ca177ffd0dd66f499ab712b0af8791cb27f2c729de9cf0f7a58df37231b9e0a5b23e6f25d4582f7bedee613fced888ff01863bf5312952beea8a646b625fe1b8b4983b9440cb6fa3b0f18e7eb4fabadc80a4f8a52dba1f9704feadcf97df8dba7e73d495a1dc63fa2945936b221e523b1507ea51d255ab0fdf753ff111cba859ab878d05e3934169b9af725969199402003e2fe3f57c224021000977fdd8dc32ec121d4415f662e7a468b021c00a799a362c0104295deb650596ab65480f06d2f2ce3a29ac1d8a8e7bae14ae870021000f20500cd8b9b5d12d4415f662e7a468b022c00bc7ca3a6e3585b8ae1a9f3e405f19b5dbd0e7ef685f1e775e6a8487478c46027c63f9c67cb86f39f4c07912c6693d7910148007801013d00c2ff010a320008eca89186061a28626531643633663965616134643336363730656638653337663965393766383033633130343834341001188491a7f79f2f118911eb0202009649138c566f510902090054ead8a1846cae68a93e6cf56155b1ea022000f361c986813978fd5ba40fb54f7e8ff1be3f8a2f1f42e116b2e60ccde07a2af9", "Received"},
	}

	for _, v := range inputs {
		input, _ := hex.DecodeString(v[0])
		output := utils.ParseBody(input, utils.CipherKey)
		log.Printf("%s", strings.Repeat("-", 25))
		log.Printf("%s the following commands", v[1])
		utils.TranslateMsg(output)
	}
}
