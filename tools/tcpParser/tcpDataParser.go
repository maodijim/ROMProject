package main

import (
	"ROMProject/utils"
	"encoding/hex"
	log "github.com/sirupsen/logrus"
	"strings"
)

func main() {
	// For Testing Data collected from WireShark
	inputs := [1][2]string{
		{"0141007801013600c9ff19103200089accb189061a283532613331366163656435316133326164373264366337626462623633376134393563303265623110019dd80ec4020200d462a92b3d812a86035600b002a4b722bb588253ed454f90b7ed056aa17949dd61d8e0e24eacfad1ce35991632c66c5417910b56602137986d2e68f66dcbfcc585ea9a0f789c541d9a8941916b620a4d5106811dd2b1d9c9c4d5d9aade85545a98af120141007801013600c9ff010b3200089bccb189061a2835366461363037636564383834323636653233306662646362323864623462313331313632326366100191600e56020200599c1993ac80f3a7020b0044b0d010e361e6a473358553912e0ee00144007801013900c6ff01123200089dccb189061a2832303630656365393736306165386362343537666130353736316639623462633763646333613530100118c83ec0ad0fb4020200be6371124ce6f0550147007801013c00c3ff37043200089eccb189061a2838646536383133643938393936363737313861626134613436306161663039353061613838313837100118b686f4c502ecc310fa038801bb6d7a4af7fb5a434847e2c3be3adfe6240ca321134a66ab78c0adc5a0fd49c279db06102f211343a50897107f105269986793be5c09c701dd9b2698e39eaaa0e6a2484275c181310e424bb82c44899606b75a28820e1cf13a320bf298d21241f9de8d4dffb9367289d8119d06193f2b782d90f7ac6b796a14de0997d372f43f41e79b0f9f09d7178e0f9630d207f3ec489934a756b9bd28199686f71535a5488ddf509d251a5663acdfec4c1fc43de2e7da56702591aac2ce13c1ce2055e0b6396f79e1c3efbcba7a87af9ea7bda39b1ff5cd3776b7a2d08c7533a160c9d87e27491f1edd4558d5c9af66bcee3bf71d99701d39f3ec99f1fef4876e364058d209aa411b9ecd2b6f5994e6769c62eb2c28d1460fa30a58eafda6224163b5fc007ddb8de62c27e18a81c44b29e23a7fe90b6e8329306d4273c20336be6b0b4ee720a1b8369c9398cd59632a5588f8fb591bbde7a5f6dfc07d8c5a016da75cb59830e7c29a0af60933a20117491e37509acd6caff807cc574250091928c3d98b477888153db2883b0f038f00efd50419ad6cba7d44d0d5bf06c5df5ff774036b87f6a1faaafa30b6719c40ae01308e850cf7a2d3d1ccbcbe1a41d98b18cf239efd15546c930f2d3926eae9cec93992f56fc3487e40897b6e7ff9a056692b34b9d8292716fef5d4fa7bd7d84b7f78cd4acb6004b74edc89b8897b6896e0201a349a371e68306793ece6dcf051711be6a122fe6b7a1933d718d1ca85330147007801013c00c3ff3703320008a1ccb189061a2838616461393030633534313038393565623731376461653239643335663134633233383431643030100118b686f4c502f33d1109020200ba171be26814f153021200f82e4aabdd8ad1d21868b755c3062df27c89afb333449f68036c009885016acf620834c22c2d2bda175a15dbc5fae1a74a56a5860910e21284d894aa6dc5658d0d67705efbc1735efd94c9290aa4b49db4ecc19514f7dce051fa9dcb951a551ba9acd27f35cd8ede48a62074adaccbeba89cc8c8d6f2621c09efd0fce9edb823ef9bafd60e10f0a4928834038d01dd27f0e3bb06b2de2cf6b036f532df92795f165bc5603dab02e67a1f32ecdd11ce1a6ccaf862231da9248d516fefea3a43b60e32bedec4139784b059fed13d6ceab261b71c986a5f7e463ce1f8f833ba60d2b7fa378f6e47e4bad4ab11a7c08e0f69b4816aefd34954a7fc8989d9eefe95deb43e7bdfe49d57cd4fb50a2b99d323386e386ac095569a5b0e404d6ed5aa2e3877e2c2253b157beee7f85f013d81fd50f1a6a2f3acd5b2feed97936a8db69f4c6aeea0bdf757377d5f8999a50b7b97263a6843dc811f58a1a67c6c2ea80b0c03a152247c422623a6fca16199b662238c977399f0133d661ccc9c5f299d54251131612c200703cff61aa521ba39ef1879d718b78b987f749e017356e58fdbb734bc9c254bea083ee68b7eb5bc51443a14159751aae3ee124d16e25ee076aef46b25f449769495af8ed1d75a913bf8e474bb7da40c0050f64880b28ac773a67dd55d106400e4661642fbee8ad26bee0b12819b72fcbddc8c174e1b84a47d2a3ab357c121812b9e602cb8c8d233f1aa61afa6ff67b3a223b505fcb9edeec302022000f361c986813978fdedde612f0f74f5a2d69229cc040055f0910ad862c7edcfed0141007801013600c9ff010b320008a5ccb189061a283362626462376631336461636131333338353637376335313533356465636232353735336166353110019b630e61020200ed4fd126717609d7020b002afaa7363a23e808f0f1ac2bbef37715", "Received"},
	}

	for _, v := range inputs {
		input, _ := hex.DecodeString(v[0])
		output := utils.ParseBody(input, utils.CipherKey)
		log.Printf("%s", strings.Repeat("-", 25))
		log.Printf("%s the following commands", v[1])
		utils.TranslateMsg(output)
	}
}
