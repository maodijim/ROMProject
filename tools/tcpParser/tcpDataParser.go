package main

import (
	"ROMProject/utils"
	"encoding/hex"
	log "github.com/sirupsen/logrus"
	"strings"
)

func main() {
	// For Testing Data collected from WireShark
	inputs := [1][2]string{
		{"034000cb03d9913046820717dffcf8cd633347a4a840343d6ba2f7879a9406a4aa30c004f62d779b3e67060fcc099e913e30bb2540b7598e019aecdd5071262b80e137022c001cc73e8613699e39312d14f0f14a2ee802fd38fe759d63d2777c6c6fbf4cf044f94a4edd3b78f102f0263e055a756273034000cb03d9913046820717dffcf8cd633347a4a840343d6ba2f7879a9406a4aa30c004f62d779b3e67060fcc099e913e30bb2540b7598e019aecdd5071262b80e137022c001cc73e8613699e39312d14f0f14a2ee877565db5abffb618777c6c6fbf4cf0440491e52eb17b10edf0263e055a7562730148007801013d00c2ff010a320010011a283336616339393935333735343462366234616337353332323439363139346437303066656634393308a5d7d38506188bfbe1959c2f9eca1168020200b342e40c218fc23702090068f8dc1ea499a3cf2075fa1fb359b9ed034000cb03d9913046820717dffcf8cd633347a4a840343d6ba2f7879a9406a4aa30c004f62d779b3e67060fcc099e913e30bb2540b7598e019aecdd5071262b80e137022c001cc73e8613699e39312d14f0f14a2ee86e26a069c13d8f45777c6c6fbf4cf0444fe629d3f30e7e65f0263e055a756273034f00c486eb27151a35c44869e806d4ac9ea17b8d5782318c1c72856fe78b5712e2a43a33d8d6de3e3c7c824f1e22389f45e8a71cac674737ad56b6fb24485129d28f10730ec8746344d4bde4128553701c1c034000cb03d9913046820717dffcf8cd633347a4a840343d6ba2f7879a9406a4aa30c004f62d779b3e67060fcc099e913e30bb2540b7598e019aecdd5071262b80e1370143007801013800c7ff0605320010011a286537323735376235336136663665636138613830333238303538326135393036613562656530616208a7d7d38506180b60280e86022c001cc73e8613699e39312d14f0f14a2ee86e3c0496b64dd472777c6c6fbf4cf04415e2f2f8ad376f45f0263e055a756273020200b342e40c218fc237032c030deaa33cef04072137ebb38c2d25e76399fb32178d3008668d0163ac071d1c5ec4ddf98c73fe037326ab815bc94e0c343602e3af2e32f8348585d757d962d822e508ddc999ca9f6bd8726f01afe41a5f1d485399cf8803cb25b61b2d723c0a38279712e749f10c9b5ccfbbd3f4a3b35f51e05ed958cea2b901ff5bdc959033a022ea0ad7bf775899a4f9b73c1ad50870d81c6655916ac803486d70197daf5026adb5d00df47f4c60bcdbfe443b07a20f18d9f006936ad959a796c3aea4ebc917e30ce944a4f8b4f049e14b1ec77dc8286cbaf8f4efd2c7943004ec82550a06acbd9402c5870cf9ad1b2cf1d99e4b8535b166e10ad1c8a7bd06f5f8c0e5f20061adf3a92f63c3e769d2d8a4a05dbcd8c1ae16483858f620017220c26439b1398313708142bfd8c2f75ff7f6d684e8b9c29b1672888a93599bad711189faf9f68c11aa0b9316f4cccb9b0c2162d99006ce92f39c2f948b8f58d4d99a39e35bbfb48aab4b2adc02193f0045edf922b12ce4048d603abbfffc7589ae9b671c57889b7ac52d49016d30c688805b9cc6b2d66b35c4a53feaad29d2e100f1e305baed0bb01d4936fb06f1c49521f3c9484d70c676af31f146e6cffe7e4670a32b44a4e1efb7a41462ee02f58886de814d8aa7d48ce850fca281dcb62008557f43818ceab101d5ac8307d613d04b00ee2dae46f7ea8d6ddf4cbab372292259a23b7868b14168c887c51a93534801c9be2a1ad833df482dfce39fc0454403509352d88cfe4e3f49d84313d9bc23d5e0b343f1f837ae4bc0490fc951538f998d7629dd6d0ef6f89bacb308d6981a512a14012ca405fb14e91afc6fcc396ce675cdb9ea30ade83552de9066855490269c75c5900d583ece1380a070d609391aeecc8446e9a948433ce8c3a541db427478f9fb2e6be98f129f2f37bf4f8b43e566ba41b543ca5120700d52e4bbc07c9810751b4c256927a7ae48cdf30661c4883437a8176d17c2142bd5932bccefe7cf72817ee7f8f8065761f90315f0cd2133d7d30d9a7725cd1bbc2ffb0eab5aeea1636e49cc0275c894995534050b4c80357f801e9e4ca4989e0f0ade3174b94c9c5c2f8b2e4c33f62c4869ab5500e2263c291917012d9506539d7ea74304fbf949b7690e49147b037f000ade00d0dd516727dd258b576b1fe6cb949b2fb9a2cbefbc3f55e68fdb8968f27a57c51815da5020ffdac86fbac87f484d8fe0678919ebd9354e8bbfa92b94bb21aaa1a658aa5531a2334a3db58701a1906812145ce31384062c8df4ad374a983289384276e2812b0947216f1d984d33d111164d81e923225754be0d5bfce000037b007b421ff29ea2bc9b97d5c7dc80cfb6bb55ff11966ae8e362780cb95d30aee9ca5d324fe0d347f13024ebd13ff3c34fedaba4833b0f987a6c40f0e67e35ddb2f66bf456a1ff1f1c6546def50e3c74f447f3f8cccdfe0aff0580ef8ed34db0b1b5fe3bb57771a81965975888dcba000b7bad498e198dfa61e45f810467f65d1ce6034201339a234e171a575fff506e507b4fca06fdbcba701e871de6b526c0539d2377d60a11cbbad633a89ab994c065fd7b83efacc07ab18a1d5df982e47f2d102b0cc01baeec05ddda63a889ad536ce9469dd90660ce0642d1099b9ede90466a1b819548d20d5e31a5436db1d053b0bdd60c14ffab4c6a7e8676ce85472b91bd0a2cfd221c58f22e57aeacdc7f0a904d255e68177f0f9ae7d26f8fcea36be02122a912d8bc6c8b385ecc38064debe6508fab3e1a3f942d0f851d1dfbd1bfb8901b03fa57680f6100b146ae71dc4b7167ff0f50616727af72f07378409ddb0037f5cc19aeb5f7490d60a443016f0da525d2d0f8e256bf42fb6d81ca75160158099918689e56d74a482ce3a22cd8926e3e484c20a59435422f1c6a3a03cfebb3955327f37727a14337071ffae25f547cb45b92712b22a9c98dd39593605e6c622f8626931859924a63e69b380145007801013a00c5ff0612320010011a283137636664636262353763366233323466646139343439306263326232373064366561373366356108a8d7d3850618c2d402a33f10dc020a00b444d8d8a73a9bfbd93d2f9ccea7e346020200aca33e7ccba84f870141007801013600c9ff010b320010011a283066343063386536326663386137643065396663316433333238623632383033366635306164393608a9d7d385064ea60e6d022400b01a630c27666017dc44ed92140492faa6b29178e4d722e497bda5246f9c3379799626837c2f3d06034000cb03d9913046820717dffcf8cd633347a4a840343d6ba2f7879a9406a4aa30c004f62d779b3e67060fcc099e913e30bb2540b7598e019aecdd5071262b80e137022c001cc73e8613699e39312d14f0f14a2ee8e4fc3f4e0cfc746a777c6c6fbf4cf044ef6eab3497350e20f0263e055a756273020200b342e40c218fc237020b0096cd2e6c83af09430557f06fcbb45072022c001cc73e8613699e39312d14f0f14a2ee8da1c3184f6c89fe7777c6c6fbf4cf044ae2f5e56b637bec4112e9cb7a791462a", "Received"},
	}

	for _, v := range inputs {
		input, _ := hex.DecodeString(v[0])
		output := utils.ParseBody(input, utils.CipherKey)
		log.Printf("%s", strings.Repeat("-", 25))
		log.Printf("%s the following commands", v[1])
		utils.TranslateMsg(output)
	}
}
